<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.37">

  <meta name="author" content="Tom Jemmett">
  <title>Data Science @ The Strategy Unit – Coffee and Coding</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-e7966c0233e7045482ebe8837d22f7e9.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
  <script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
  <link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
  <script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
  <script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
  <link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
  <script src="../../site_libs/leaflet-binding-2.2.1/leaflet.js"></script>
  <script src="../../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
  <script src="../../site_libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Coffee and Coding</h1>
  <p class="subtitle">Working with Geospatial Data in R</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="mailto:thomas.jemmett@nhs.net" target="_blank">Tom Jemmett</a> 
</div>
</div>
</div>

  <p class="date">Aug 24, 2023</p>
</section>
<section id="packages-we-are-using-today" class="slide level2">
<h2>Packages we are using today</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a><span class="fu">library</span>(sf)</span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="fu">library</span>(tidygeocoder)</span>
<span id="cb1-6"><a></a><span class="fu">library</span>(PostcodesioR)</span>
<span id="cb1-7"><a></a></span>
<span id="cb1-8"><a></a><span class="fu">library</span>(osrm)</span>
<span id="cb1-9"><a></a></span>
<span id="cb1-10"><a></a><span class="fu">library</span>(leaflet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="getting-boundary-data" class="slide level2">
<h2>Getting boundary data</h2>
<p>We can use the <a href="https://geoportal.statistics.gov.uk/">ONS’s Geoportal</a> we can grab boundary data to generate maps</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>icb_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb2-2"><a></a>  <span class="st">"https://services1.arcgis.com"</span>,</span>
<span id="cb2-3"><a></a>  <span class="st">"/ESMARspQHYMw9BZ9/arcgis"</span>,</span>
<span id="cb2-4"><a></a>  <span class="st">"/rest/services"</span>,</span>
<span id="cb2-5"><a></a>  <span class="st">"/Integrated_Care_Boards_April_2023_EN_BGC"</span>,</span>
<span id="cb2-6"><a></a>  <span class="st">"/FeatureServer/0/query"</span>,</span>
<span id="cb2-7"><a></a>  <span class="st">"?outFields=*&amp;where=1%3D1&amp;f=geojson"</span></span>
<span id="cb2-8"><a></a>)</span>
<span id="cb2-9"><a></a>icb_boundaries <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(icb_url)</span>
<span id="cb2-10"><a></a></span>
<span id="cb2-11"><a></a>icb_boundaries <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb2-13"><a></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb2-14"><a></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/icb-plot-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="what-is-the-icb_boundaries-data" class="slide level2">
<h2>What is the <code>icb_boundaries</code> data?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>icb_boundaries <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a></a>  <span class="fu">select</span>(ICB23CD, ICB23NM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 42 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -6.418667 ymin: 49.86479 xmax: 1.763706 ymax: 55.81112
Geodetic CRS:  WGS 84
# A tibble: 42 × 3
   ICB23CD   ICB23NM                                                    geometry
   &lt;chr&gt;     &lt;chr&gt;                                            &lt;MULTIPOLYGON [°]&gt;
 1 E54000008 NHS Cheshire and Merseyside Integrated C… (((-3.083264 53.2559, -3…
 2 E54000010 NHS Staffordshire and Stoke-on-Trent Int… (((-1.950489 53.21188, -…
 3 E54000011 NHS Shropshire, Telford and Wrekin Integ… (((-2.380794 52.99841, -…
 4 E54000013 NHS Lincolnshire Integrated Care Board    (((0.2687853 52.81584, 0…
 5 E54000015 NHS Leicester, Leicestershire and Rutlan… (((-0.7875237 52.97762, …
 6 E54000018 NHS Coventry and Warwickshire Integrated… (((-1.577608 52.67858, -…
 7 E54000019 NHS Herefordshire and Worcestershire Int… (((-2.272042 52.43972, -…
 8 E54000022 NHS Norfolk and Waveney Integrated Care … (((1.666741 52.31366, 1.…
 9 E54000023 NHS Suffolk and North East Essex Integra… (((0.8997023 51.7732, 0.…
10 E54000024 NHS Bedfordshire, Luton and Milton Keyne… (((-0.4577115 52.32009, …
# ℹ 32 more rows</code></pre>
</div>
</div>
</section>
<section id="working-with-geospatial-dataframes" class="slide level2">
<h2>Working with geospatial dataframes</h2>
<p>We can simply join <code>sf</code> data frames and “regular” data frames together</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>icb_metrics <span class="ot">&lt;-</span> icb_boundaries <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a></a>  <span class="fu">select</span>(ICB23CD) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a></a>  <span class="fu">mutate</span>(<span class="at">admissions =</span> <span class="fu">rpois</span>(<span class="fu">n</span>(), <span class="dv">1000000</span>))</span>
<span id="cb5-5"><a></a></span>
<span id="cb5-6"><a></a>icb_boundaries <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a></a>  <span class="fu">inner_join</span>(icb_metrics, <span class="at">by =</span> <span class="st">"ICB23CD"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> admissions)) <span class="sc">+</span></span>
<span id="cb5-10"><a></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb5-11"><a></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/icb-metrics-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="working-with-geospatial-data-frames" class="slide level2">
<h2>Working with geospatial data frames</h2>
<p>We can manipulate <code>sf</code> objects like other data frames</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>london_icbs <span class="ot">&lt;-</span> icb_boundaries <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a></a>  <span class="fu">filter</span>(ICB23NM <span class="sc">|&gt;</span> stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="st">"London"</span>))</span>
<span id="cb6-3"><a></a></span>
<span id="cb6-4"><a></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> london_icbs) <span class="sc">+</span></span>
<span id="cb6-6"><a></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">st_centroid</span>(london_icbs)) <span class="sc">+</span></span>
<span id="cb6-7"><a></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/london-icbs-1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="working-with-geospatial-data-frames-1" class="slide level2">
<h2>Working with geospatial data frames</h2>
<p>Summarising the data will combine the geometries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>london_icbs <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a></a>  <span class="fu">summarise</span>(<span class="at">area =</span> <span class="fu">sum</span>(Shape__Area)) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a></a>  <span class="co"># and use geospatial functions to create calculations using the geometry</span></span>
<span id="cb7-4"><a></a>  <span class="fu">mutate</span>(<span class="at">new_area =</span> <span class="fu">st_area</span>(geometry), <span class="at">.before =</span> <span class="st">"geometry"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -0.5102803 ymin: 51.28676 xmax: 0.3340241 ymax: 51.69188
Geodetic CRS:  WGS 84
# A tibble: 1 × 3
         area    new_area                                               geometry
*       &lt;dbl&gt;       [m^2]                                     &lt;MULTIPOLYGON [°]&gt;
1 1573336388. 1567995610. (((-0.3314819 51.43935, -0.3306676 51.43889, -0.33118…</code></pre>
</div>
</div>
<p><br> Why the difference in area?</p>
<div class="fragment">
<p><br> We are using a simplified geometry, so calculating the area will be slightly inaccurate. The original area was calculated on the non-simplified geometries.</p>
</div>
</section>
<section id="creating-our-own-geospatial-data" class="slide level2">
<h2>Creating our own geospatial data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>location_raw <span class="ot">&lt;-</span> <span class="fu">postcode_lookup</span>(<span class="st">"B2 4BJ"</span>)</span>
<span id="cb9-2"><a></a><span class="fu">glimpse</span>(location_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 40
$ postcode                             &lt;chr&gt; "B2 4BJ"
$ quality                              &lt;int&gt; 1
$ eastings                             &lt;int&gt; 406866
$ northings                            &lt;int&gt; 286775
$ country                              &lt;chr&gt; "England"
$ nhs_ha                               &lt;chr&gt; "West Midlands"
$ longitude                            &lt;dbl&gt; -1.90033
$ latitude                             &lt;dbl&gt; 52.47887
$ european_electoral_region            &lt;chr&gt; "West Midlands"
$ primary_care_trust                   &lt;chr&gt; "Heart of Birmingham Teaching"
$ region                               &lt;chr&gt; "West Midlands"
$ lsoa                                 &lt;chr&gt; "Birmingham 138A"
$ msoa                                 &lt;chr&gt; "Birmingham 138"
$ incode                               &lt;chr&gt; "4BJ"
$ outcode                              &lt;chr&gt; "B2"
$ parliamentary_constituency           &lt;chr&gt; "Birmingham, Ladywood"
$ parliamentary_constituency_2024      &lt;chr&gt; "Birmingham Ladywood"
$ admin_district                       &lt;chr&gt; "Birmingham"
$ parish                               &lt;chr&gt; "Birmingham, unparished area"
$ admin_county                         &lt;lgl&gt; NA
$ date_of_introduction                 &lt;chr&gt; "198001"
$ admin_ward                           &lt;chr&gt; "Ladywood"
$ ced                                  &lt;lgl&gt; NA
$ ccg                                  &lt;chr&gt; "NHS Birmingham and Solihull"
$ nuts                                 &lt;chr&gt; "Birmingham"
$ pfa                                  &lt;chr&gt; "West Midlands"
$ admin_district_code                  &lt;chr&gt; "E08000025"
$ admin_county_code                    &lt;chr&gt; "E99999999"
$ admin_ward_code                      &lt;chr&gt; "E05011151"
$ parish_code                          &lt;chr&gt; "E43000250"
$ parliamentary_constituency_code      &lt;chr&gt; "E14000564"
$ parliamentary_constituency_2024_code &lt;chr&gt; "E14001096"
$ ccg_code                             &lt;chr&gt; "E38000258"
$ ccg_id_code                          &lt;chr&gt; "15E"
$ ced_code                             &lt;chr&gt; "E99999999"
$ nuts_code                            &lt;chr&gt; "TLG31"
$ lsoa_code                            &lt;chr&gt; "E01033620"
$ msoa_code                            &lt;chr&gt; "E02006899"
$ lau2_code                            &lt;chr&gt; "E08000025"
$ pfa_code                             &lt;chr&gt; "E23000014"</code></pre>
</div>
</div>
<div class="fragment">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>location <span class="ot">&lt;-</span> location_raw <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"eastings"</span>, <span class="st">"northings"</span>), <span class="at">crs =</span> <span class="dv">27700</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a></a>  <span class="fu">select</span>(postcode, ccg) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb11-5"><a></a></span>
<span id="cb11-6"><a></a>location</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -1.900335 ymin: 52.47886 xmax: -1.900335 ymax: 52.47886
Geodetic CRS:  WGS 84
  postcode                         ccg                   geometry
1   B2 4BJ NHS Birmingham and Solihull POINT (-1.900335 52.47886)</code></pre>
</div>
</div>
</div>
</section>
<section id="creating-a-geospatial-data-frame-for-all-nhs-trusts" class="slide level2">
<h2>Creating a geospatial data frame for all NHS Trusts</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co"># using the NHSRtools package</span></span>
<span id="cb13-2"><a></a><span class="co"># remotes::install_github("NHS-R-Community/NHSRtools")</span></span>
<span id="cb13-3"><a></a>trusts <span class="ot">&lt;-</span> <span class="fu">ods_get_trusts</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a></a>  <span class="fu">filter</span>(status <span class="sc">==</span> <span class="st">"Active"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a></a>  <span class="fu">select</span>(name, org_id, post_code) <span class="sc">|&gt;</span></span>
<span id="cb13-6"><a></a>  <span class="fu">geocode</span>(<span class="at">postalcode =</span> <span class="st">"post_code"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-7"><a></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"long"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>trusts <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a></a>  <span class="fu">leaflet</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a></a>  <span class="fu">addProviderTiles</span>(<span class="st">"Stamen.TonerLite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a></a>  <span class="fu">addMarkers</span>(<span class="at">popup =</span> <span class="sc">~</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-b5ca9fed28c0d5f5ee53" style="width:960px;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-b5ca9fed28c0d5f5ee53">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[53.89763915,53.42125,51.3766453,51.3885999,51.56820595,51.5798282,53.55913,51.51794173333333,51.51717,51.5581374,52.1287054,51.8938451,51.4162039,52.48416265,52.4875426,52.4849032,52.4532477,53.82056863,53.5522814,53.80643576666666,53.41408441666667,50.8194391,51.6629999,52.8177353,53.65547,52.1848097,52.3210626,52.17374,51.5242002,51.52284,53.46244,51.4842839,53.2117014,53.23621,50.47176,53.20984215,54.5306627,52.45659,51.3900178,55.00649,51.4347634,53.2396699,52.91830586666667,50.7155182,53.53078,50.71294,50.7393002,52.48176,51.5077567,51.9244338,53.26247105,51.2663722,53.7359807,51.51350176666667,52.98152207222222,52.0766227,51.9098515,50.8882967,51.380458825,51.6310333,51.3199061,54.93784345,52.51258,51.8471078,51.8471078,51.8921411,53.53357313333333,51.5222431,51.5384852,51.49869091,51.5163529,51.2820482,53.9938316,52.4780976,51.53201,52.1921622,51.8021534,51.7669801,51.55005135,51.42746766666667,53.7439724,53.772057,51.5174679,52.057037875,50.711856475,52.5616405,51.2725763,51.17165272,52.40246875,51.468693075,51.4149843,53.71864585,53.791064875,53.82104,53.76273,53.8069351,52.6765,51.4537118,53.22647,53.24403,53.4040514,53.41071688,53.4106201,53.39846,51.50017,51.57518,51.274735,53.46244,51.3798003,53.4200523,53.42402,51.5542554,53.11924,51.77441107777778,52.81063,52.8114015,53.6930006,52.0262824,51.5272967,51.51328705,52.6172528,52.6596812,52.6341417,52.2362387,52.3937272,51.4967618375,54.896737,54.896737,54.96877165,51.51858,53.4874685,53.54486,51.72981,51.6134549,52.96837,54.7021082,55.0264714,53.579,52.5846459,53.4283563,51.57518,52.9794709,52.9434616,51.75409,51.7508399,51.764955,51.43479,53.51788,53.48581,50.7213477,50.84952205,51.47679195,51.13552387222222,53.4948,51.45009923333333,51.48974,50.2663955,50.71754113333333,51.553116,53.4106201,51.63257,52.1735144,51.2413044,51.39222078,50.8439405,51.04395,52.4876369,54.2822481,53.3805265,53.40992015,53.1357303,52.70584,50.9016066,51.01131495,51.89152508,51.132702,50.93065535,51.6310333,51.3826416,51.41846575,53.63355,54.55172303333334,54.9027696,54.9716368,52.289886,50.7203945,51.4361418,53.6983924125,53.0101462,51.42662115,53.38378,51.29759,51.21919,50.8304866,50.8412099,53.49153,51.01131495,51.5469,54.54568,54.5432286,53.4296417,53.3316004,52.5024733,51.5254692,55.002468,51.77153,52.7556864,52.88421,53.41397,50.74792185,51.49056,52.4211275,52.59972,52.7088654,53.4664,50.48228603333333,53.45406,53.23358,51.52573,53.38792,52.4532961,51.45914555,52.42121,50.7213477,52.91076916923077,52.6282994,54.3066377,53.00167625,50.93284118333333,50.4160585,50.8165539,51.56592,52.5827874,53.3937446,53.25194,51.6489199,51.5066106,51.4738269,52.48565,51.3220963,52.231145,50.8412099,51.5665599,51.0612162,53.38003,53.3698806,52.1920534,53.5578171,52.05701,50.9446928,53.9704476,53.70850653333333],[-1.964989,-2.8978,-0.5262388,-2.39231,0.18083295,-0.0898069,-1.49949,-0.0595585,-0.05605,0.4510627,-0.4724881,-0.4742934,-0.739521,-1.91766305,-1.88628205,-1.89424115,-1.9428605,-3.01282045,-2.42954,-1.796465166666667,-2.528533,-0.118152457142857,-0.62143,-1.6566665,-1.81634,0.188339,-0.063814566666667,0.13911,-0.1422208,-0.15154,-2.22771,-0.181603,-2.8992312,-1.40005,-4.74082,-2.8994141,-1.5636355,-1.48692,-0.1102686,-1.6331,0.2592812,-1.4794799,-1.512895833333333,-3.5064242,-1.10894,-2.44694,-1.9806425,-2.11786,-0.34480975,-0.2121547,-2.1404771,1.0874518,-2.4635709,-0.072287533333333,-1.238102161111111,0.0141455,0.8989391,0.5615019,-0.184936225,0.5396917,-0.741712533333333,-1.58111405,-1.47844,-2.17648,-2.17648,-2.0719683,-2.295755333333333,-0.12045525,-1.7263778,-0.11902804,-0.2373684,-1.10991855,-1.5180971,-1.8287586,-0.57399,-2.179037866666667,-0.19420635,-0.2166447,-0.04598355,-0.326230466666667,-0.3542056,-0.4446037,-0.1753826,1.19793665,-1.301087275,1.7176868,0.4866078,0.8709745800000001,-0.7427838,-0.093666925,-0.2825102,-2.64102015,-2.706316125,-1.53496,-1.57564,-1.521480325,-1.1030199,-0.01769825,-0.52415,-0.55691,-2.9299076,-2.89991586,-2.9648089,-2.96008,-0.10903,-0.3215279,0.484431,-2.22771,0.5416386,-2.7876834,-2.82642,0.6883155,-2.4762267,0.465254255555556,-2.10927,-2.0968631,-1.488184192307692,-0.7359102,-0.09013549999999999,-0.07041565,1.22130875,1.2513472,1.2625801,-0.8839991,-0.7206623,-2.5921841625,-2.9583574,-2.9583574,-1.7109424,0.17113,-2.3243642,-0.09623,0.46716,-0.0750372,-2.1678099,-1.228027,-1.4653033,-2.47581,-0.278872888888889,-2.6081423,-0.3215279,-1.12655,-1.185488929411765,-1.20898,-1.22232,-1.2204345,0.17474,-2.2295,-2.09998,-1.9729168,-1.071349575,-3.1699144,-0.001661988888889,-1.14598,-0.957996833333333,-0.17085,-5.0931487,-3.5083626,-0.1652263,-2.9648089,-0.31044,0.1359492,-0.608939075,-2.39161986,-0.7690264,-1.78982,-1.9302035,-0.4362387,-1.4907278,-1.45673255,-1.2358982,-2.78937,-1.3297985,-3.1194584,-1.14980004,-0.16871155,-1.5274733,0.5396917,-0.0311969,0.10416845,-2.9788199,-1.214676466666667,-1.4087054,-1.4292464,-1.5847948,-3.464713725,-0.1702862,-1.492420475,-2.2285516,-0.174634866666667,-2.1320199,-0.33563,-0.1620099,-0.1138015,-0.41116,-2.07143,-3.1194584,-0.17544,-1.1468,-1.5912038,-2.2302095,-3.0253121,-2.12124055,-0.4615393,-1.5937828,0.08545999999999999,0.4436087,-3.03269,-1.34288,-1.82095565,-0.17257,-1.9607413,-2.09556,-2.793386066666667,-2.931,-3.553696333333334,-2.37068,-0.51964,-0.13741,-2.29318,-1.9384003,-2.59328625,-1.4383999,-1.9729168,-1.513825592307692,-1.1356811,-2.7324755,-2.2129189,-1.434252983333333,-4.114495,-0.3639575,-3.27787,-1.99850025,-2.6089577,-3.47833,-0.40419,-0.3628311,-0.324781,-2.11905,-2.9718147,0.7085741,-0.41116,-0.1393414,-1.3294775,-3.02653,-3.0956782,-2.1840806,-2.6296517,-2.70571,-2.6344361,-1.0839298,-1.5179028],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["AIREDALE NHS FOUNDATION TRUST","ALDER HEY CHILDREN'S NHS FOUNDATION TRUST","ASHFORD AND ST PETER'S HOSPITALS NHS FOUNDATION TRUST","AVON AND WILTSHIRE MENTAL HEALTH PARTNERSHIP NHS TRUST","BARKING, HAVERING AND REDBRIDGE UNIVERSITY HOSPITALS NHS TRUST","BARNET, ENFIELD AND HARINGEY MENTAL HEALTH NHS TRUST","BARNSLEY HOSPITAL NHS FOUNDATION TRUST","BARTS AND THE LONDON NHS TRUST","BARTS HEALTH NHS TRUST","BASILDON AND THURROCK UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","BEDFORD HOSPITAL NHS TRUST","BEDFORDSHIRE HOSPITALS NHS FOUNDATION TRUST","BERKSHIRE HEALTHCARE NHS FOUNDATION TRUST","BIRMINGHAM AND SOLIHULL MENTAL HEALTH NHS FOUNDATION TRUST","BIRMINGHAM COMMUNITY HEALTHCARE NHS FOUNDATION TRUST","BIRMINGHAM WOMEN'S AND CHILDREN'S NHS FOUNDATION TRUST","BIRMINGHAM WOMEN'S NHS FOUNDATION TRUST","BLACKPOOL TEACHING HOSPITALS NHS FOUNDATION TRUST","BOLTON NHS FOUNDATION TRUST","BRADFORD TEACHING HOSPITALS NHS FOUNDATION TRUST","BRIDGEWATER COMMUNITY HEALTHCARE NHS FOUNDATION TRUST","BRIGHTON AND SUSSEX UNIVERSITY HOSPITALS NHS TRUST","BUCKINGHAMSHIRE HEALTHCARE NHS TRUST","BURTON HOSPITALS NHS FOUNDATION TRUST","CALDERDALE AND HUDDERSFIELD NHS FOUNDATION TRUST","CAMBRIDGESHIRE AND PETERBOROUGH NHS FOUNDATION TRUST","CAMBRIDGESHIRE COMMUNITY SERVICES NHS TRUST","CAMBRIDGE UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","CENTRAL AND NORTH WEST LONDON NHS FOUNDATION TRUST","CENTRAL LONDON COMMUNITY HEALTHCARE NHS TRUST","CENTRAL MANCHESTER UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","CHELSEA AND WESTMINSTER HOSPITAL NHS FOUNDATION TRUST","CHESHIRE AND WIRRAL PARTNERSHIP NHS FOUNDATION TRUST","CHESTERFIELD ROYAL HOSPITAL NHS FOUNDATION TRUST","CORNWALL PARTNERSHIP NHS FOUNDATION TRUST","COUNTESS OF CHESTER HOSPITAL NHS FOUNDATION TRUST","COUNTY DURHAM AND DARLINGTON NHS FOUNDATION TRUST","COVENTRY AND WARWICKSHIRE PARTNERSHIP NHS TRUST","CROYDON HEALTH SERVICES NHS TRUST","CUMBRIA, NORTHUMBERLAND, TYNE AND WEAR NHS FOUNDATION TRUST","DARTFORD AND GRAVESHAM NHS TRUST","DERBYSHIRE COMMUNITY HEALTH SERVICES NHS FOUNDATION TRUST","DERBYSHIRE HEALTHCARE NHS FOUNDATION TRUST","DEVON PARTNERSHIP NHS TRUST","DONCASTER AND BASSETLAW TEACHING HOSPITALS NHS FOUNDATION TRUST","DORSET COUNTY HOSPITAL NHS FOUNDATION TRUST","DORSET HEALTHCARE UNIVERSITY NHS FOUNDATION TRUST","DUDLEY INTEGRATED HEALTH AND CARE NHS TRUST","EALING HOSPITAL NHS TRUST","EAST AND NORTH HERTFORDSHIRE NHS TRUST","EAST CHESHIRE NHS TRUST","EAST KENT HOSPITALS UNIVERSITY NHS FOUNDATION TRUST","EAST LANCASHIRE HOSPITALS NHS TRUST","EAST LONDON NHS FOUNDATION TRUST","EAST MIDLANDS AMBULANCE SERVICE NHS TRUST","EAST OF ENGLAND AMBULANCE SERVICE NHS TRUST","EAST SUFFOLK AND NORTH ESSEX NHS FOUNDATION TRUST","EAST SUSSEX HEALTHCARE NHS TRUST","EPSOM AND ST HELIER UNIVERSITY HOSPITALS NHS TRUST","ESSEX PARTNERSHIP UNIVERSITY NHS FOUNDATION TRUST","FRIMLEY HEALTH NHS FOUNDATION TRUST","GATESHEAD HEALTH NHS FOUNDATION TRUST","GEORGE ELIOT HOSPITAL NHS TRUST","GLOUCESTERSHIRE CARE SERVICES NHS TRUST","GLOUCESTERSHIRE HEALTH AND CARE NHS FOUNDATION TRUST","GLOUCESTERSHIRE HOSPITALS NHS FOUNDATION TRUST","GREATER MANCHESTER MENTAL HEALTH NHS FOUNDATION TRUST","GREAT ORMOND STREET HOSPITAL FOR CHILDREN NHS FOUNDATION TRUST","GREAT WESTERN HOSPITALS NHS FOUNDATION TRUST","GUY'S AND ST THOMAS' NHS FOUNDATION TRUST","HAMMERSMITH HOSPITALS NHS TRUST","HAMPSHIRE HOSPITALS NHS FOUNDATION TRUST","HARROGATE AND DISTRICT NHS FOUNDATION TRUST","HEART OF ENGLAND NHS FOUNDATION TRUST","HEATHERWOOD AND WEXHAM PARK HOSPITALS NHS FOUNDATION TRUST","HEREFORDSHIRE AND WORCESTERSHIRE HEALTH AND CARE NHS TRUST","HERTFORDSHIRE COMMUNITY NHS TRUST","HERTFORDSHIRE PARTNERSHIP UNIVERSITY NHS FOUNDATION TRUST","HOMERTON HEALTHCARE NHS FOUNDATION TRUST","HOUNSLOW AND RICHMOND COMMUNITY HEALTHCARE NHS TRUST","HULL UNIVERSITY TEACHING HOSPITALS NHS TRUST","HUMBER TEACHING NHS FOUNDATION TRUST","IMPERIAL COLLEGE HEALTHCARE NHS TRUST","IPSWICH HOSPITAL NHS TRUST","ISLE OF WIGHT NHS TRUST","JAMES PAGET UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","KENT AND MEDWAY NHS AND SOCIAL CARE PARTNERSHIP TRUST","KENT COMMUNITY HEALTH NHS FOUNDATION TRUST","KETTERING GENERAL HOSPITAL NHS FOUNDATION TRUST","KING'S COLLEGE HOSPITAL NHS FOUNDATION TRUST","KINGSTON HOSPITAL NHS FOUNDATION TRUST","LANCASHIRE & SOUTH CUMBRIA NHS FOUNDATION TRUST","LANCASHIRE TEACHING HOSPITALS NHS FOUNDATION TRUST","LEEDS AND YORK PARTNERSHIP NHS FOUNDATION TRUST","LEEDS COMMUNITY HEALTHCARE NHS TRUST","LEEDS TEACHING HOSPITALS NHS TRUST","LEICESTERSHIRE PARTNERSHIP NHS TRUST","LEWISHAM AND GREENWICH NHS TRUST","LINCOLNSHIRE COMMUNITY HEALTH SERVICES NHS TRUST","LINCOLNSHIRE PARTNERSHIP NHS FOUNDATION TRUST","LIVERPOOL COMMUNITY HEALTH NHS TRUST","LIVERPOOL HEART AND CHEST HOSPITAL NHS FOUNDATION TRUST","LIVERPOOL UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","LIVERPOOL WOMEN'S NHS FOUNDATION TRUST","LONDON AMBULANCE SERVICE NHS TRUST","LONDON NORTH WEST UNIVERSITY HEALTHCARE NHS TRUST","MAIDSTONE AND TUNBRIDGE WELLS NHS TRUST","MANCHESTER UNIVERSITY NHS FOUNDATION TRUST","MEDWAY NHS FOUNDATION TRUST","MERSEY AND WEST LANCASHIRE TEACHING HOSPITALS NHS TRUST","MERSEY CARE NHS FOUNDATION TRUST","MID AND SOUTH ESSEX NHS FOUNDATION TRUST","MID CHESHIRE HOSPITALS NHS FOUNDATION TRUST","MID ESSEX HOSPITAL SERVICES NHS TRUST","MIDLANDS PARTNERSHIP NHS FOUNDATION TRUST","MID STAFFORDSHIRE NHS FOUNDATION TRUST","MID YORKSHIRE TEACHING NHS TRUST","MILTON KEYNES UNIVERSITY HOSPITAL NHS FOUNDATION TRUST","MOORFIELDS EYE HOSPITAL NHS FOUNDATION TRUST","NHS DIRECT NHS TRUST","NORFOLK AND NORWICH UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","NORFOLK AND SUFFOLK NHS FOUNDATION TRUST","NORFOLK COMMUNITY HEALTH AND CARE NHS TRUST","NORTHAMPTON GENERAL HOSPITAL NHS TRUST","NORTHAMPTONSHIRE HEALTHCARE NHS FOUNDATION TRUST","NORTH BRISTOL NHS TRUST","NORTH CUMBRIA INTEGRATED CARE NHS FOUNDATION TRUST","NORTH CUMBRIA UNIVERSITY HOSPITALS NHS TRUST","NORTH EAST AMBULANCE SERVICE NHS FOUNDATION TRUST","NORTH EAST LONDON NHS FOUNDATION TRUST","NORTHERN CARE ALLIANCE NHS FOUNDATION TRUST","NORTHERN LINCOLNSHIRE AND GOOLE NHS FOUNDATION TRUST","NORTH ESSEX PARTNERSHIP UNIVERSITY NHS FOUNDATION TRUST","NORTH MIDDLESEX UNIVERSITY HOSPITAL NHS TRUST","NORTH STAFFORDSHIRE COMBINED HEALTHCARE NHS TRUST","NORTH TEES AND HARTLEPOOL NHS FOUNDATION TRUST","NORTHUMBRIA HEALTHCARE NHS FOUNDATION TRUST","NORTH WEST AMBULANCE SERVICE NHS TRUST","NORTH WEST ANGLIA NHS FOUNDATION TRUST","NORTH WEST BOROUGHS HEALTHCARE NHS FOUNDATION TRUST","NORTH WEST LONDON HOSPITALS NHS TRUST","NOTTINGHAMSHIRE HEALTHCARE NHS FOUNDATION TRUST","NOTTINGHAM UNIVERSITY HOSPITALS NHS TRUST","NUFFIELD ORTHOPAEDIC CENTRE NHS TRUST","OXFORD HEALTH NHS FOUNDATION TRUST","OXFORD UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","OXLEAS NHS FOUNDATION TRUST","PENNINE ACUTE HOSPITALS NHS TRUST","PENNINE CARE NHS FOUNDATION TRUST","POOLE HOSPITAL NHS FOUNDATION TRUST","PORTSMOUTH HOSPITALS UNIVERSITY NATIONAL HEALTH SERVICE TRUST","PUBLIC HEALTH WALES NHS TRUST","QUEEN VICTORIA HOSPITAL NHS FOUNDATION TRUST","ROTHERHAM DONCASTER AND SOUTH HUMBER NHS FOUNDATION TRUST","ROYAL BERKSHIRE NHS FOUNDATION TRUST","ROYAL BROMPTON & HAREFIELD NHS FOUNDATION TRUST","ROYAL CORNWALL HOSPITALS NHS TRUST","ROYAL DEVON UNIVERSITY HEALTHCARE NHS FOUNDATION TRUST","ROYAL FREE LONDON NHS FOUNDATION TRUST","ROYAL LIVERPOOL AND BROADGREEN UNIVERSITY HOSPITALS NHS TRUST","ROYAL NATIONAL ORTHOPAEDIC HOSPITAL NHS TRUST","ROYAL PAPWORTH HOSPITAL NHS FOUNDATION TRUST","ROYAL SURREY COUNTY HOSPITAL NHS FOUNDATION TRUST","ROYAL UNITED HOSPITALS BATH NHS FOUNDATION TRUST","ROYAL WEST SUSSEX NHS TRUST","SALISBURY NHS FOUNDATION TRUST","SANDWELL AND WEST BIRMINGHAM HOSPITALS NHS TRUST","SCARBOROUGH AND NORTH EAST YORKSHIRE HEALTH CARE NHS TRUST","SHEFFIELD CHILDREN'S NHS FOUNDATION TRUST","SHEFFIELD TEACHING HOSPITALS NHS FOUNDATION TRUST","SHERWOOD FOREST HOSPITALS NHS FOUNDATION TRUST","SHROPSHIRE COMMUNITY HEALTH NHS TRUST","SOLENT NHS TRUST","SOMERSET NHS FOUNDATION TRUST","SOUTH CENTRAL AMBULANCE SERVICE NHS FOUNDATION TRUST","SOUTH EAST COAST AMBULANCE SERVICE NHS FOUNDATION TRUST","SOUTHERN HEALTH NHS FOUNDATION TRUST","SOUTH ESSEX PARTNERSHIP UNIVERSITY NHS FOUNDATION TRUST","SOUTH LONDON AND MAUDSLEY NHS FOUNDATION TRUST","SOUTH LONDON HEALTHCARE NHS TRUST","SOUTHPORT AND ORMSKIRK HOSPITAL NHS TRUST","SOUTH TEES HOSPITALS NHS FOUNDATION TRUST","SOUTH TYNESIDE AND SUNDERLAND NHS FOUNDATION TRUST","SOUTH TYNESIDE NHS FOUNDATION TRUST","SOUTH WARWICKSHIRE UNIVERSITY NHS FOUNDATION TRUST","SOUTH WESTERN AMBULANCE SERVICE NHS FOUNDATION TRUST","SOUTH WEST LONDON AND ST GEORGE'S MENTAL HEALTH NHS TRUST","SOUTH WEST YORKSHIRE PARTNERSHIP NHS FOUNDATION TRUST","STAFFORDSHIRE AND STOKE ON TRENT PARTNERSHIP NHS TRUST","ST GEORGE'S UNIVERSITY HOSPITALS NHS FOUNDATION TRUST","STOCKPORT NHS FOUNDATION TRUST","SURREY AND BORDERS PARTNERSHIP NHS FOUNDATION TRUST","SURREY AND SUSSEX HEALTHCARE NHS TRUST","SUSSEX COMMUNITY NHS FOUNDATION TRUST","SUSSEX PARTNERSHIP NHS FOUNDATION TRUST","TAMESIDE AND GLOSSOP INTEGRATED CARE NHS FOUNDATION TRUST","TAUNTON AND SOMERSET NHS FOUNDATION TRUST","TAVISTOCK AND PORTMAN NHS FOUNDATION TRUST","TEES AND NORTH EAST YORKSHIRE NHS TRUST","TEES, ESK AND WEAR VALLEYS NHS FOUNDATION TRUST","THE CHRISTIE NHS FOUNDATION TRUST","THE CLATTERBRIDGE CANCER CENTRE NHS FOUNDATION TRUST","THE DUDLEY GROUP NHS FOUNDATION TRUST","THE HILLINGDON HOSPITALS NHS FOUNDATION TRUST","THE NEWCASTLE UPON TYNE HOSPITALS NHS FOUNDATION TRUST","THE PRINCESS ALEXANDRA HOSPITAL NHS TRUST","THE QUEEN ELIZABETH HOSPITAL, KING'S LYNN, NHS FOUNDATION TRUST","THE ROBERT JONES AND AGNES HUNT ORTHOPAEDIC HOSPITAL NHS FOUNDATION TRUST","THE ROTHERHAM NHS FOUNDATION TRUST","THE ROYAL BOURNEMOUTH AND CHRISTCHURCH HOSPITALS NHS FOUNDATION TRUST","THE ROYAL MARSDEN NHS FOUNDATION TRUST","THE ROYAL ORTHOPAEDIC HOSPITAL NHS FOUNDATION TRUST","THE ROYAL WOLVERHAMPTON NHS TRUST","THE SHREWSBURY AND TELFORD HOSPITAL NHS TRUST","THE WALTON CENTRE NHS FOUNDATION TRUST","TORBAY AND SOUTH DEVON NHS FOUNDATION TRUST","TRAFFORD HEALTHCARE NHS TRUST","UNITED LINCOLNSHIRE HOSPITALS NHS TRUST","UNIVERSITY COLLEGE LONDON HOSPITALS NHS FOUNDATION TRUST","UNIVERSITY HOSPITAL OF SOUTH MANCHESTER NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS BIRMINGHAM NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS BRISTOL AND WESTON NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS COVENTRY AND WARWICKSHIRE NHS TRUST","UNIVERSITY HOSPITALS DORSET NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS OF DERBY AND BURTON NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS OF LEICESTER NHS TRUST","UNIVERSITY HOSPITALS OF MORECAMBE BAY NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS OF NORTH MIDLANDS NHS TRUST","UNIVERSITY HOSPITAL SOUTHAMPTON NHS FOUNDATION TRUST","UNIVERSITY HOSPITALS PLYMOUTH NHS TRUST","UNIVERSITY HOSPITALS SUSSEX NHS FOUNDATION TRUST","VELINDRE NHS TRUST","WALSALL HEALTHCARE NHS TRUST","WARRINGTON AND HALTON TEACHING HOSPITALS NHS FOUNDATION TRUST","WELSH AMBULANCE SERVICES NHS TRUST","WEST HERTFORDSHIRE TEACHING HOSPITALS NHS TRUST","WEST LONDON NHS TRUST","WEST MIDDLESEX UNIVERSITY HOSPITAL NHS TRUST","WEST MIDLANDS AMBULANCE SERVICE UNIVERSITY NHS FOUNDATION TRUST","WESTON AREA HEALTH NHS TRUST","WEST SUFFOLK NHS FOUNDATION TRUST","WEST SUSSEX HEALTH AND SOCIAL CARE NHS TRUST","WHITTINGTON HEALTH NHS TRUST","WINCHESTER AND EASTLEIGH HEALTHCARE NHS TRUST","WIRRAL COMMUNITY HEALTH AND CARE NHS FOUNDATION TRUST","WIRRAL UNIVERSITY TEACHING HOSPITAL NHS FOUNDATION TRUST","WORCESTERSHIRE ACUTE HOSPITALS NHS TRUST","WRIGHTINGTON, WIGAN AND LEIGH NHS FOUNDATION TRUST","WYE VALLEY NHS TRUST","YEOVIL DISTRICT HOSPITAL NHS FOUNDATION TRUST","YORK AND SCARBOROUGH TEACHING HOSPITALS NHS FOUNDATION TRUST","YORKSHIRE AMBULANCE SERVICE NHS TRUST"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[50.2663955,55.0264714],"lng":[-5.0931487,1.7176868]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div></div>
</section>
<section id="what-are-the-nearest-trusts-to-our-location" class="slide level2">
<h2>What are the nearest trusts to our location?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>nearest_trusts <span class="ot">&lt;-</span> trusts <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-3"><a></a>    <span class="at">distance =</span> <span class="fu">st_distance</span>(geometry, location)[, <span class="dv">1</span>]</span>
<span id="cb15-4"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a></a>  <span class="fu">arrange</span>(distance) <span class="sc">|&gt;</span></span>
<span id="cb15-6"><a></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb15-7"><a></a></span>
<span id="cb15-8"><a></a>nearest_trusts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -1.9384 ymin: 52.4533 xmax: -1.886282 ymax: 52.48764
Geodetic CRS:  WGS 84
# A tibble: 5 × 5
  name                       org_id post_code             geometry distance
  &lt;chr&gt;                      &lt;chr&gt;  &lt;chr&gt;              &lt;POINT [°]&gt;      [m]
1 BIRMINGHAM WOMEN'S AND CH… RQ3    B4 6NH     (-1.894241 52.4849)     789.
2 BIRMINGHAM AND SOLIHULL M… RXT    B1 3RB    (-1.917663 52.48416)    1313.
3 BIRMINGHAM COMMUNITY HEAL… RYW    B7 4BN    (-1.886282 52.48754)    1356.
4 SANDWELL AND WEST BIRMING… RXK    B18 7QH   (-1.930203 52.48764)    2246.
5 UNIVERSITY HOSPITALS BIRM… RRK    B15 2GW      (-1.9384 52.4533)    3838.</code></pre>
</div>
</div>
</section>
<section id="lets-find-driving-routes-to-these-trusts" class="slide level2">
<h2>Let’s find driving routes to these trusts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>routes <span class="ot">&lt;-</span> nearest_trusts <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-3"><a></a>    <span class="at">route =</span> <span class="fu">map</span>(geometry, <span class="sc">~</span> <span class="fu">osrmRoute</span>(location, <span class="fu">st_coordinates</span>(.x)))</span>
<span id="cb17-4"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-6"><a></a>  <span class="fu">rename</span>(<span class="at">straight_line_distance =</span> distance) <span class="sc">|&gt;</span></span>
<span id="cb17-7"><a></a>  <span class="fu">unnest</span>(route) <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb17-9"><a></a></span>
<span id="cb17-10"><a></a>routes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 8 fields
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: -1.93846 ymin: 52.45316 xmax: -1.88527 ymax: 52.49279
Geodetic CRS:  WGS 84
# A tibble: 5 × 9
  name     org_id post_code straight_line_distance src   dst   duration distance
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;                        [m] &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 BIRMING… RQ3    B4 6NH                      789. 1     dst       5.77     3.09
2 BIRMING… RXT    B1 3RB                     1313. 1     dst       6.84     4.14
3 BIRMING… RYW    B7 4BN                     1356. 1     dst       7.59     4.29
4 SANDWEL… RXK    B18 7QH                    2246. 1     dst       8.78     4.95
5 UNIVERS… RRK    B15 2GW                    3838. 1     dst      10.6      4.67
# ℹ 1 more variable: geometry &lt;LINESTRING [°]&gt;</code></pre>
</div>
</div>
</section>
<section id="lets-show-the-routes" class="slide level2">
<h2>Let’s show the routes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">leaflet</span>(routes) <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a></a>  <span class="fu">addTiles</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a></a>  <span class="fu">addMarkers</span>(<span class="at">data =</span> location) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a></a>  <span class="fu">addPolylines</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">weight =</span> <span class="dv">3</span>, <span class="at">opacity =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data =</span> nearest_trusts, <span class="at">radius =</span> <span class="dv">4</span>, <span class="at">opacity =</span> <span class="dv">1</span>, <span class="at">fillOpacity =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-2a7b0361e53b56e37f7b" style="width:1920px;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-2a7b0361e53b56e37f7b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[52.47885967601437,-1.900335475630854,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[-1.90037000179291,-1.89982998371124,-1.90319991111755,-1.90046000480652,-1.90006995201111,-1.9001100063324,-1.9004499912262,-1.90075993537903,-1.90087997913361,-1.90286993980408,-1.90295994281769,-1.90506994724274,-1.90617001056671,-1.90609991550446,-1.90111994743347,-1.89996993541718,-1.89809989929199,-1.89647996425629,-1.8958899974823,-1.89359998703003,-1.89279997348785,-1.89222991466522,-1.89184999465942,-1.89177000522614,-1.892009973526,-1.89233994483948,-1.89407992362976,-1.89409995079041,-1.89487993717194],"lat":[52.4787101745605,52.4786682128906,52.4775276184082,52.475227355957,52.4751091003418,52.4746971130371,52.4745597839355,52.4746589660645,52.4751396179199,52.4767875671387,52.4769897460938,52.4785270690918,52.4799690246582,52.4804573059082,52.484260559082,52.4849281311035,52.4853401184082,52.4860801696777,52.4861869812012,52.4860000610352,52.4864196777344,52.4864082336426,52.4862403869629,52.4858894348145,52.4856185913086,52.4855690002441,52.4858169555664,52.4856986999512,52.485279083252]}]],[[{"lng":[-1.90037000179291,-1.89982998371124,-1.90319991111755,-1.90046000480652,-1.90006995201111,-1.90004992485046,-1.90024995803833,-1.90149998664856,-1.90548992156982,-1.9096999168396,-1.90985989570618,-1.91094994544983,-1.91181993484497,-1.91479992866516,-1.91780996322632,-1.91863000392914,-1.9190399646759,-1.91909992694855,-1.92144989967346,-1.92357993125916,-1.9265398979187,-1.9268399477005,-1.92672991752625,-1.92635989189148,-1.92144000530243,-1.91957998275757,-1.91925990581512,-1.91863989830017,-1.91769993305206,-1.9176299571991],"lat":[52.4787101745605,52.4786682128906,52.4775276184082,52.475227355957,52.4751091003418,52.4747886657715,52.474609375,52.4744300842285,52.473030090332,52.4726982116699,52.4724884033203,52.4720268249512,52.4710273742676,52.4719772338867,52.4725303649902,52.4725074768066,52.4728202819824,52.4734992980957,52.4743995666504,52.475528717041,52.4773101806641,52.4778099060059,52.4789772033691,52.4796981811523,52.4839096069336,52.4848899841309,52.4848670959473,52.4845771789551,52.4839668273926,52.4841499328613]}]],[[{"lng":[-1.90037000179291,-1.89982998371124,-1.90319991111755,-1.90006995201111,-1.9001100063324,-1.9004499912262,-1.90295994281769,-1.90506994724274,-1.90617001056671,-1.90609991550446,-1.89996993541718,-1.89809989929199,-1.89634990692139,-1.89554989337921,-1.89359998703003,-1.89292991161346,-1.89184999465942,-1.88949990272522,-1.88902997970581,-1.88933992385864,-1.88896989822388,-1.88835990428925,-1.88773000240326,-1.88526999950409,-1.88726997375488,-1.88653993606567],"lat":[52.4787101745605,52.4786682128906,52.4775276184082,52.4751091003418,52.4746971130371,52.4745597839355,52.4769897460938,52.4785270690918,52.4799690246582,52.4804573059082,52.4849281311035,52.4853401184082,52.4861068725586,52.4862098693848,52.4860000610352,52.4863891601562,52.4865875244141,52.4905281066895,52.4916572570801,52.4924201965332,52.4927673339844,52.492790222168,52.4925270080566,52.4891891479492,52.487907409668,52.4874000549316]}]],[[{"lng":[-1.90037000179291,-1.89982998371124,-1.90319991111755,-1.90006995201111,-1.90024995803833,-1.90149998664856,-1.90548992156982,-1.9096999168396,-1.91094994544983,-1.91181993484497,-1.91479992866516,-1.91780996322632,-1.91863000392914,-1.9190399646759,-1.91909992694855,-1.92144989967346,-1.9265398979187,-1.93593990802765,-1.93711996078491,-1.93107998371124,-1.9310998916626,-1.92938995361328,-1.92895996570587,-1.93023991584778],"lat":[52.4787101745605,52.4786682128906,52.4775276184082,52.4751091003418,52.474609375,52.4744300842285,52.473030090332,52.4726982116699,52.4720268249512,52.4710273742676,52.4719772338867,52.4725303649902,52.4725074768066,52.4728202819824,52.4734992980957,52.4743995666504,52.4773101806641,52.4842491149902,52.4866104125977,52.4869575500488,52.4872589111328,52.4872894287109,52.4880104064941,52.4879493713379]}]],[[{"lng":[-1.90037000179291,-1.89982998371124,-1.90319991111755,-1.90006995201111,-1.90012991428375,-1.90149998664856,-1.90548992156982,-1.9096999168396,-1.91094994544983,-1.9119199514389,-1.91301000118256,-1.91384994983673,-1.91498994827271,-1.92012000083923,-1.92123997211456,-1.92395997047424,-1.92697989940643,-1.92966997623444,-1.93509995937347,-1.93619990348816,-1.93845999240875],"lat":[52.4787101745605,52.4786682128906,52.4775276184082,52.4751091003418,52.4746704101562,52.4744300842285,52.473030090332,52.4726982116699,52.4720268249512,52.4707298278809,52.4698295593262,52.4683380126953,52.4638900756836,52.4602394104004,52.4598083496094,52.4594879150391,52.45751953125,52.4576873779297,52.4531593322754,52.4537887573242,52.4536590576172]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"black","weight":3,"opacity":1,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[52.4849032,52.48416265,52.4875426,52.4876369,52.4532961],[-1.89424115,-1.91766305,-1.88628205,-1.9302035,-1.9384003],4,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":1,"fill":true,"fillColor":"#03F","fillOpacity":1},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[52.4531593322754,52.492790222168],"lng":[-1.93845999240875,-1.88526999950409]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="we-can-use-osrm-to-calculate-isochrones" class="slide level2">
<h2>We can use <code>{osrm}</code> to calculate isochrones</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>iso <span class="ot">&lt;-</span> <span class="fu">osrmIsochrone</span>(location, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">15</span>), <span class="at">res =</span> <span class="dv">10</span>)</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a>isochrone_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(iso<span class="sc">$</span>id)</span>
<span id="cb20-4"><a></a></span>
<span id="cb20-5"><a></a>pal <span class="ot">&lt;-</span> <span class="fu">colorFactor</span>(</span>
<span id="cb20-6"><a></a>  viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="fu">length</span>(isochrone_ids)),</span>
<span id="cb20-7"><a></a>  isochrone_ids</span>
<span id="cb20-8"><a></a>)</span>
<span id="cb20-9"><a></a></span>
<span id="cb20-10"><a></a><span class="fu">leaflet</span>(location) <span class="sc">|&gt;</span></span>
<span id="cb20-11"><a></a>  <span class="fu">addProviderTiles</span>(<span class="st">"Stamen.TonerLite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-12"><a></a>  <span class="fu">addMarkers</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-13"><a></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb20-14"><a></a>    <span class="at">data =</span> iso,</span>
<span id="cb20-15"><a></a>    <span class="at">fillColor =</span> <span class="sc">~</span> <span class="fu">pal</span>(id),</span>
<span id="cb20-16"><a></a>    <span class="at">color =</span> <span class="st">"#000000"</span>,</span>
<span id="cb20-17"><a></a>    <span class="at">weight =</span> <span class="dv">1</span></span>
<span id="cb20-18"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-1ab23485e04b67c8ecbf" style="width:864px;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-1ab23485e04b67c8ecbf">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[52.47885967601437,-1.900335475630854,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolygons","args":[[[[{"lng":[-1.780564628784062,-2.020115371215938,-2.16460629522246,-2.146735049358496,-2.020115371215938,-1.780564628784062,-1.607865256333175,-1.660104826875462,-1.780564628784062],"lat":[52.65755415856427,52.66456279624089,52.55174921944566,52.40584982891697,52.34329420195999,52.35548352952055,52.40584982891697,52.55174921944566,52.65755415856427]}]],[[{"lng":[-1.780564628784062,-2.020115371215938,-2.259666113647804,-2.492994758873656,-2.36660840937632,-2.34213440202599,-2.272423253777312,-2.259666113647804,-2.020115371215938,-1.780564628784062,-1.541013886352187,-1.52815210152363,-1.325418218163507,-1.433980575903906,-1.427840307250518,-1.541013886352187,-1.780564628784062],"lat":[52.79248449046973,52.77683599947032,52.7942719171175,52.69716513449276,52.55174921944566,52.40584982891697,52.25946630465785,52.2413854657438,52.20146006946057,52.22817509976532,52.25096544321072,52.25946630465785,52.40584982891697,52.55174921944566,52.69716513449276,52.76116568720293,52.79248449046973]},{"lng":[-1.660104826875462,-1.780564628784062,-2.020115371215938,-2.16460629522246,-2.146735049358496,-2.020115371215938,-1.780564628784062,-1.607865256333175,-1.660104826875462],"lat":[52.55174921944566,52.65755415856427,52.66456279624089,52.55174921944566,52.40584982891697,52.34329420195999,52.35548352952055,52.40584982891697,52.55174921944566]}]],[[{"lng":[-1.541013886352187,-1.780564628784062,-2.020115371215938,-2.056969331590071,-2.259666113647804,-2.462362895705545,-2.499216856079679,-2.539141979818325,-2.738767598511555,-2.913574897042917,-2.738767598511555,-2.703013756357543,-2.499216856079679,-2.489399202701324,-2.485042255935781,-2.474263653743026,-2.259666113647804,-2.020115371215938,-1.780564628784062,-1.541013886352187,-1.381313391397609,-1.301463143920321,-1.187991739610485,-1.061912401488445,-0.8502163965486522,-1.061912401488445,-1.091125906663064,-1.087670545835959,-1.088236658898541,-1.301463143920321,-1.541013886352187],"lat":[52.96937793637391,52.97198008502192,52.96401051000469,52.98654922248213,53.1084009112254,52.98654922248213,52.86620686856757,52.84209824260375,52.80297470451444,52.69716513449276,52.59109846692184,52.55174921944566,52.42765657839892,52.40584982891697,52.25946630465785,52.11259799885484,51.98061628780422,51.98324025089058,52.0003725568761,52.01441615678107,52.11259799885484,52.18995757627355,52.25946630465785,52.27651254004886,52.40584982891697,52.5348090272595,52.55174921944566,52.69716513449276,52.84209824260375,52.97069904680414,52.96937793637391]},{"lng":[-2.259666113647804,-2.492994758873656,-2.36660840937632,-2.34213440202599,-2.272423253777312,-2.259666113647804,-2.020115371215938,-1.780564628784062,-1.541013886352187,-1.52815210152363,-1.325418218163507,-1.433980575903906,-1.427840307250518,-1.541013886352187,-1.780564628784062,-2.020115371215938,-2.259666113647804],"lat":[52.7942719171175,52.69716513449276,52.55174921944566,52.40584982891697,52.25946630465785,52.2413854657438,52.20146006946057,52.22817509976532,52.25096544321072,52.25946630465785,52.40584982891697,52.55174921944566,52.69716513449276,52.76116568720293,52.79248449046973,52.77683599947032,52.7942719171175]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#000000","weight":1,"opacity":0.5,"fill":true,"fillColor":["#440154","#21908C","#FDE725"],"fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.98061628780422,53.1084009112254],"lng":[-2.913574897042917,-0.8502163965486522]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div></div>
</section>
<section id="what-trusts-are-in-the-isochrones" class="slide level2">
<h2>What trusts are in the isochrones?</h2>
<p>The <code>summarise()</code> function will “union” the geometry</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="fu">summarise</span>(iso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 0 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -2.913575 ymin: 51.98062 xmax: -0.8502164 ymax: 53.1084
Geodetic CRS:  WGS 84
                        geometry
1 POLYGON ((-1.541014 52.9693...</code></pre>
</div>
</div>
</section>
<section id="what-trusts-are-in-the-isochrones-1" class="slide level2">
<h2>What trusts are in the isochrones?</h2>
<p>We can use this with a geo-filter to find the trusts in the isochrone</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="co"># also works</span></span>
<span id="cb23-2"><a></a>trusts_in_iso <span class="ot">&lt;-</span> trusts <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a></a>  <span class="fu">st_filter</span>(</span>
<span id="cb23-4"><a></a>    <span class="fu">summarise</span>(iso),</span>
<span id="cb23-5"><a></a>    <span class="at">.predicate =</span> st_within</span>
<span id="cb23-6"><a></a>  )</span>
<span id="cb23-7"><a></a></span>
<span id="cb23-8"><a></a>trusts_in_iso</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 31 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -2.793386 ymin: 52.19205 xmax: -1.10302 ymax: 53.01015
Geodetic CRS:  WGS 84
# A tibble: 31 × 4
   name                               org_id post_code             geometry
 * &lt;chr&gt;                              &lt;chr&gt;  &lt;chr&gt;              &lt;POINT [°]&gt;
 1 BIRMINGHAM AND SOLIHULL MENTAL HE… RXT    B1 3RB    (-1.917663 52.48416)
 2 BIRMINGHAM COMMUNITY HEALTHCARE N… RYW    B7 4BN    (-1.886282 52.48754)
 3 BIRMINGHAM WOMEN'S AND CHILDREN'S… RQ3    B4 6NH     (-1.894241 52.4849)
 4 BIRMINGHAM WOMEN'S NHS FOUNDATION… RLU    B15 2TG   (-1.942861 52.45325)
 5 BURTON HOSPITALS NHS FOUNDATION T… RJF    DE13 0RB  (-1.656667 52.81774)
 6 COVENTRY AND WARWICKSHIRE PARTNER… RYG    CV6 6NY    (-1.48692 52.45659)
 7 DERBYSHIRE HEALTHCARE NHS FOUNDAT… RXM    DE22 3LZ  (-1.512896 52.91831)
 8 DUDLEY INTEGRATED HEALTH AND CARE… RYK    DY5 1RU    (-2.11786 52.48176)
 9 GEORGE ELIOT HOSPITAL NHS TRUST    RLT    CV10 7DJ   (-1.47844 52.51258)
10 HEART OF ENGLAND NHS FOUNDATION T… RR1    B9 5ST     (-1.828759 52.4781)
# ℹ 21 more rows</code></pre>
</div>
</div>
</section>
<section id="what-trusts-are-in-the-isochrones-2" class="slide level2">
<h2>What trusts are in the isochrones?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a><span class="fu">leaflet</span>(trusts_in_iso) <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a></a>  <span class="fu">addProviderTiles</span>(<span class="st">"Stamen.TonerLite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a></a>  <span class="fu">addMarkers</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb25-5"><a></a>    <span class="at">data =</span> iso,</span>
<span id="cb25-6"><a></a>    <span class="at">fillColor =</span> <span class="sc">~</span><span class="fu">pal</span>(id),</span>
<span id="cb25-7"><a></a>    <span class="at">color =</span> <span class="st">"#000000"</span>,</span>
<span id="cb25-8"><a></a>    <span class="at">weight =</span> <span class="dv">1</span></span>
<span id="cb25-9"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-69880987a69dd57b45b5" style="width:864px;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-69880987a69dd57b45b5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[52.48416265,52.4875426,52.4849032,52.4532477,52.8177353,52.45659,52.91830586666667,52.48176,52.51258,52.4780976,52.1921622,52.6765,52.81063,52.8114015,52.96837,52.4876369,52.70584,52.289886,53.0101462,52.5024733,52.4211275,52.59972,52.7088654,52.4532961,52.42121,52.91076916923077,52.6282994,53.00167625,52.5827874,52.48565,52.1920534],[-1.91766305,-1.88628205,-1.89424115,-1.9428605,-1.6566665,-1.48692,-1.512895833333333,-2.11786,-1.47844,-1.8287586,-2.179037866666667,-1.1030199,-2.10927,-2.0968631,-2.1678099,-1.9302035,-2.78937,-1.5847948,-2.2285516,-2.12124055,-1.9607413,-2.09556,-2.793386066666667,-1.9384003,-1.4383999,-1.513825592307692,-1.1356811,-2.2129189,-1.99850025,-2.11905,-2.1840806],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolygons","args":[[[[{"lng":[-1.780564628784062,-2.020115371215938,-2.16460629522246,-2.146735049358496,-2.020115371215938,-1.780564628784062,-1.607865256333175,-1.660104826875462,-1.780564628784062],"lat":[52.65755415856427,52.66456279624089,52.55174921944566,52.40584982891697,52.34329420195999,52.35548352952055,52.40584982891697,52.55174921944566,52.65755415856427]}]],[[{"lng":[-1.780564628784062,-2.020115371215938,-2.259666113647804,-2.492994758873656,-2.36660840937632,-2.34213440202599,-2.272423253777312,-2.259666113647804,-2.020115371215938,-1.780564628784062,-1.541013886352187,-1.52815210152363,-1.325418218163507,-1.433980575903906,-1.427840307250518,-1.541013886352187,-1.780564628784062],"lat":[52.79248449046973,52.77683599947032,52.7942719171175,52.69716513449276,52.55174921944566,52.40584982891697,52.25946630465785,52.2413854657438,52.20146006946057,52.22817509976532,52.25096544321072,52.25946630465785,52.40584982891697,52.55174921944566,52.69716513449276,52.76116568720293,52.79248449046973]},{"lng":[-1.660104826875462,-1.780564628784062,-2.020115371215938,-2.16460629522246,-2.146735049358496,-2.020115371215938,-1.780564628784062,-1.607865256333175,-1.660104826875462],"lat":[52.55174921944566,52.65755415856427,52.66456279624089,52.55174921944566,52.40584982891697,52.34329420195999,52.35548352952055,52.40584982891697,52.55174921944566]}]],[[{"lng":[-1.541013886352187,-1.780564628784062,-2.020115371215938,-2.056969331590071,-2.259666113647804,-2.462362895705545,-2.499216856079679,-2.539141979818325,-2.738767598511555,-2.913574897042917,-2.738767598511555,-2.703013756357543,-2.499216856079679,-2.489399202701324,-2.485042255935781,-2.474263653743026,-2.259666113647804,-2.020115371215938,-1.780564628784062,-1.541013886352187,-1.381313391397609,-1.301463143920321,-1.187991739610485,-1.061912401488445,-0.8502163965486522,-1.061912401488445,-1.091125906663064,-1.087670545835959,-1.088236658898541,-1.301463143920321,-1.541013886352187],"lat":[52.96937793637391,52.97198008502192,52.96401051000469,52.98654922248213,53.1084009112254,52.98654922248213,52.86620686856757,52.84209824260375,52.80297470451444,52.69716513449276,52.59109846692184,52.55174921944566,52.42765657839892,52.40584982891697,52.25946630465785,52.11259799885484,51.98061628780422,51.98324025089058,52.0003725568761,52.01441615678107,52.11259799885484,52.18995757627355,52.25946630465785,52.27651254004886,52.40584982891697,52.5348090272595,52.55174921944566,52.69716513449276,52.84209824260375,52.97069904680414,52.96937793637391]},{"lng":[-2.259666113647804,-2.492994758873656,-2.36660840937632,-2.34213440202599,-2.272423253777312,-2.259666113647804,-2.020115371215938,-1.780564628784062,-1.541013886352187,-1.52815210152363,-1.325418218163507,-1.433980575903906,-1.427840307250518,-1.541013886352187,-1.780564628784062,-2.020115371215938,-2.259666113647804],"lat":[52.7942719171175,52.69716513449276,52.55174921944566,52.40584982891697,52.25946630465785,52.2413854657438,52.20146006946057,52.22817509976532,52.25096544321072,52.25946630465785,52.40584982891697,52.55174921944566,52.69716513449276,52.76116568720293,52.79248449046973,52.77683599947032,52.7942719171175]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#000000","weight":1,"opacity":0.5,"fill":true,"fillColor":["#440154","#21908C","#FDE725"],"fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[51.98061628780422,53.1084009112254],"lng":[-2.913574897042917,-0.8502163965486522]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div></div>
</section>
<section id="doing-the-same-but-within-a-radius" class="slide level2">
<h2>Doing the same but within a radius</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>r <span class="ot">&lt;-</span> <span class="dv">25000</span></span>
<span id="cb26-2"><a></a></span>
<span id="cb26-3"><a></a>trusts_in_radius <span class="ot">&lt;-</span> trusts <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a></a>  <span class="fu">st_filter</span>(</span>
<span id="cb26-5"><a></a>    location,</span>
<span id="cb26-6"><a></a>    <span class="at">.predicate =</span> st_is_within_distance,</span>
<span id="cb26-7"><a></a>    <span class="at">dist =</span> r</span>
<span id="cb26-8"><a></a>  )</span>
<span id="cb26-9"><a></a></span>
<span id="cb26-10"><a></a><span class="co"># transforming gives us a pretty smooth circle</span></span>
<span id="cb26-11"><a></a>radius <span class="ot">&lt;-</span> location <span class="sc">|&gt;</span></span>
<span id="cb26-12"><a></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">27700</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-13"><a></a>  <span class="fu">st_buffer</span>(<span class="at">dist =</span> r) <span class="sc">|&gt;</span></span>
<span id="cb26-14"><a></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb26-15"><a></a></span>
<span id="cb26-16"><a></a><span class="fu">leaflet</span>(trusts_in_radius) <span class="sc">|&gt;</span></span>
<span id="cb26-17"><a></a>  <span class="fu">addProviderTiles</span>(<span class="st">"Stamen.TonerLite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-18"><a></a>  <span class="fu">addMarkers</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-19"><a></a>  <span class="fu">addPolygons</span>(</span>
<span id="cb26-20"><a></a>    <span class="at">data =</span> radius,</span>
<span id="cb26-21"><a></a>    <span class="at">color =</span> <span class="st">"#000000"</span>,</span>
<span id="cb26-22"><a></a>    <span class="at">weight =</span> <span class="dv">1</span></span>
<span id="cb26-23"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-1347d2a1d549a2358c9e" style="width:864px;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-1347d2a1d549a2358c9e">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[52.48416265,52.4875426,52.4849032,52.4532477,52.48176,52.4780976,52.4876369,52.5024733,52.4211275,52.59972,52.4532961,52.5827874,52.48565],[-1.91766305,-1.88628205,-1.89424115,-1.9428605,-2.11786,-1.8287586,-1.9302035,-2.12124055,-1.9607413,-2.09556,-1.9384003,-1.99850025,-2.11905],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolygons","args":[[[[{"lng":[-1.532250540910105,-1.532879454686442,-1.534514618247516,-1.537150757217414,-1.540779873558017,-1.545391275876139,-1.55097161677623,-1.557504937070768,-1.564972716646845,-1.573353931775207,-1.582625118637045,-1.592760442834174,-1.60373177463971,-1.615508769739013,-1.628058955204314,-1.641347820441159,-1.655338912840315,-1.669993937865197,-1.685272863301971,-1.701134027397275,-1.717534250606803,-1.734428950676858,-1.751772260780206,-1.769517150427158,-1.787615548872623,-1.806018470740019,-1.824676143583024,-1.843538137106566,-1.862553493768716,-1.881670860485547,-1.900838621161325,-1.92000502976666,-1.939118343687444,-1.958126957067472,-1.976979533867638,-1.995625140364498,-2.014013376810732,-2.032094507979857,-2.049819592317052,-2.06714060941773,-2.084010585555033,-2.100383716977148,-2.116215490695112,-2.131462802481735,-2.146084071802372,-2.160039353398743,-2.173290445247754,-2.185800992618435,-2.197536587951863,-2.208464866291141,-2.218555595991437,-2.227780764443812,-2.23611465855095,-2.243533939698398,-2.250017712971224,-2.255547590373475,-2.260107747816411,-2.263684975651167,-2.266268722532668,-2.267851132413817,-2.268427074482768,-2.267994165871132,-2.266552786977468,-2.264106089268282,-2.260659995438106,-2.256223191830897,-2.250807113047031,-2.244425918683573,-2.237096462180024,-2.22883825176751,-2.219673403546177,-2.209626586743221,-2.198724961232559,-2.186998107426234,-2.174477948677386,-2.161198666364514,-2.147196607856877,-2.132510187590915,-2.117179781517303,-2.101247615207485,-2.084757645937168,-2.067755439091801,-2.050288039265662,-2.032403836451277,-2.014152427739549,-1.995584474972825,-1.976751558813102,-1.957706029705368,-1.938500856231693,-1.919189471364876,-1.899825617141103,-1.880463188279191,-1.861156075279343,-1.841958007537028,-1.822922397007538,-1.804102182953873,-1.785549678305126,-1.767316418144242,-1.749453010833218,-1.732008992270448,-1.715032683759255,-1.698571053948557,-1.682669585286695,-1.667372145407366,-1.652720863842928,-1.638756014435091,-1.625515903786438,-1.613036766068492,-1.601352664473476,-1.590495399567608,-1.580494424773995,-1.57137676918322,-1.563166967859549,-1.555886999780838,-1.549556233520518,-1.544191380750981,-1.539806457619175,-1.536412754017634,-1.534018810747385,-1.532630404543569,-1.532250540910105],"lat":[52.4779778535615,52.46621776985113,52.45449386232325,52.44283822226632,52.43128272906101,52.41985896359461,52.40859812275241,52.39753093520798,52.38668757872763,52.37609759919824,52.36578983158102,52.35579232298555,52.34613225805214,52.3368358868218,52.32792845526611,52.3194341386399,52.31137597781261,52.303775818725,52.29665425510897,52.29003057460095,52.28392270836854,52.27834718436348,52.27331908430302,52.26885200447483,52.26495802044978,52.26164765577969,52.25892985474674,52.25681195922325,52.25529968969094,52.25439713046013,52.25410671912012,52.25442924024311,52.25536382335502,52.25690794517746,52.25905743613633,52.2618064911232,52.26514768448677,52.26907198922301,52.27356880032298,52.27862596222875,52.28422980033871,52.29036515649476,52.29701542837423,52.30416261270159,52.31178735218461,52.31986898607204,52.32838560422002,52.3373141045463,52.34663025374192,52.35630875110206,52.36632329532849,52.3766466541479,52.38725073658228,52.3981066676988,52.40918486565915,52.42045512088031,52.43188667711137,52.44344831422369,52.45510843250482,52.46683513824002,52.47859633035974,52.49035978792429,52.5020932582138,52.51376454518481,52.52534159805247,52.53679259975289,52.54808605503774,52.55919087795113,52.57007647843752,52.58071284782853,52.59107064295747,52.60112126865091,52.610836958349,52.62019085260916,52.62915707525159,52.63771080690996,52.64582835575642,52.65348722517687,52.66066617817999,52.66734529833265,52.67350604702323,52.67913131686588,52.68420548106921,52.68871443860546,52.69264565503006,52.69598819881374,52.69873277306514,52.70087174253648,52.70239915582044,52.70331076266245,52.70360402632979,52.70327813099436,52.70233398410473,52.70077421373863,52.69860316094557,52.69582686710554,52.6924530563473,52.68849111308622,52.68395205475846,52.67884849984419,52.67319463128805,52.66700615544024,52.66030025665633,52.65309554770693,52.64541201616212,52.63727096692723,52.62869496111828,52.61970775147529,52.61033421452213,52.60060027968918,52.59053285562375,52.58015975391877,52.56950961049739,52.55861180489459,52.54749637768157,52.53619394628131,52.52473561942556,52.51315291050513,52.50147765006458,52.48974189769321,52.4779778535615]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#000000","weight":1,"opacity":0.5,"fill":true,"fillColor":"#000000","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[52.25410671912012,52.70360402632979],"lng":[-2.268427074482768,-1.532250540910105]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div></div>
</section>
<section id="further-reading" class="slide level2">
<h2>Further reading</h2>
<ul>
<li><a href="https://r.geocompx.org/">Geocomputation with R</a></li>
<li><a href="https://r-spatial.org/">r-spatial</a></li>
<li><a href="https://r-spatial.github.io/sf/">{sf} documentation</a></li>
<li><a href="https://rstudio.github.io/leaflet/">Leaflet documentation</a></li>
<li><a href="https://luukvdmeer.github.io/sfnetworks/">Tidy Geospatial Networks in R</a></li>
</ul>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>view slides at <a href="https://the-strategy-unit.github.io/data_science/presentations/">the-strategy-unit.github.io/data_science/presentations</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/the-strategy-unit\.github\.io\/data_science");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>